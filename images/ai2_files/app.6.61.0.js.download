function G(){import.meta.url,import("_").catch(()=>1);async function*e(){}}const O="modulepreload",T=function(e){return"/"+e},d={},g=function(t,o,a){if(!o||o.length===0)return t();const i=document.getElementsByTagName("link");return Promise.all(o.map(s=>{if(s=T(s),s in d)return;d[s]=!0;const n=s.endsWith(".css"),A=n?'[rel="stylesheet"]':"";if(!!a)for(let E=i.length-1;E>=0;E--){const _=i[E];if(_.href===s&&(!n||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${A}`))return;const r=document.createElement("link");if(r.rel=n?"stylesheet":O,n||(r.as="script",r.crossOrigin=""),r.href=s,document.head.appendChild(r),n)return new Promise((E,_)=>{r.addEventListener("load",E),r.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t()).catch(s=>{const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=s,window.dispatchEvent(n),!n.defaultPrevented)throw s})};function c(e){const t={VITE_BACKEND_BASE_URL:"https://api.grow.me",VITE_FIREBASE_API_KEY:"AIzaSyC-jIuCQMNEDKPVWUI0QaC9ksxOrgTWigc",VITE_FIREBASE_AUTH_DOMAIN:"grow-faves.firebaseapp.com",VITE_FIREBASE_DATABASE_URL:"https://grow-faves.firebaseio.com",VITE_FIREBASE_PROJECT_ID:"grow-faves",VITE_FIREBASE_STORAGE_BUCKET:"grow-faves.appspot.com",VITE_FIREBASE_MESSAGE_SENDER_ID:"1006509562140",VITE_FIREBASE_APP_ID:"1:1006509562140:web:984f4eef9d5cfae9fe42d9",VITE_FIREBASE_MEASUREMENT_ID:"G-4L07WZ5MW7",VITE_LOGIN_REGISTER_BASE_URL:"https://app.grow.me",VITE_MAIN_BACKEND_BASE_URL:"https://api.grow.me",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,LEGACY:!1,VITE_PACKAGE_VERSION:"6.61.0"}[e];if(!t)throw new Error(`Required environment variable "${e}" not found`);return t}const b=c("VITE_FIREBASE_API_KEY"),j=c("VITE_FIREBASE_AUTH_DOMAIN"),$=c("VITE_FIREBASE_DATABASE_URL"),H=c("VITE_FIREBASE_PROJECT_ID"),Y=c("VITE_FIREBASE_STORAGE_BUCKET"),x=c("VITE_FIREBASE_MESSAGE_SENDER_ID"),q=c("VITE_FIREBASE_APP_ID");c("VITE_FIREBASE_MEASUREMENT_ID");const L=c("VITE_BACKEND_BASE_URL"),J=c("VITE_LOGIN_REGISTER_BASE_URL"),Q="https://www.grow.me/tos.html",z="https://www.grow.me/",X="https://www.mediavine.com/privacy-policy/?publisher=www.grow.me",Z="grow.me@mediavine.com",ee="https://www.facebook.com/mediavinepublishernetwork",te="https://www.instagram.com/mediavine",oe="https://twitter.com/mediavine",N="growme",C="grow-me-app-prod",D="https://snowplow.mediavine.com/com.snowplowanalytics.snowplow/tp2",ne=c("VITE_PACKAGE_VERSION"),se="iglu:com.snowplowanalytics.snowplow/unstruct_event/jsonschema/1-0-0",ae="iglu:com.snowplowanalytics.snowplow/contexts/jsonschema/1-0-0",ie="iglu:com.mediavine/site/jsonschema/1-0-0",re="iglu:com.mediavine/user/jsonschema/1-0-0",ce="iglu:com.mediavine/click_event/jsonschema/1-0-0";function I(e){var t=document.cookie.match(`(^|;)\\s*${e}\\s*=\\s*([^;]+)`);return t?t.pop():""}function P(e){return new Date(Date.now()+Number(e)*1e3).toUTCString()}const m="grow_unverified_reader_id",B="growme_has_logged_in",S="grow_check_third_party_cookie_support";let l=window.location.hostname.split(".").slice(-2).join(".");l!=="localhost"&&(l=`.${l}`);function R({name:e,value:t}){let o=new Date;o.setTime(o.getTime()+15778463e4);const a=[`${e}=${t}`,`domain=${l}`,"SameSite=None","Secure",`expires=${o.toUTCString()}`].filter(Boolean).join("; ");document.cookie=a}async function u(e,t){const{SNOWPLOW_COLLECTOR_URL:o,SNOWPLOW_APP_ID:a,SNOWPLOW_TRACKER_NAMESPACE:i}=t;try{await fetch(o,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({schema:"iglu:com.snowplowanalytics.snowplow/payload_data/jsonschema/1-0-4",data:[{aid:a,dtm:String(Date.now()),e:"se",p:"web",se_ca:"pageActions",se_ac:e,tna:i,tv:"0.1.0",ua:navigator.userAgent,url:window.location.href}]})})}catch(s){}}function U(e,t){const o=I(m);o&&(e.postMessage({type:"GROW_UNVERIFIED_READER_ID_FOUND",unverifiedReaderId:o},"*"),u("unverified_reader_id_found_in_iframe",t))}const y="grow_anonymous_id";function v(e){const t=I(y);t&&e.postMessage({type:"MV_ANONYMOUS_ID_FOUND",anonymousId:t},"*")}function M(){return R({name:S,value:"test"}),!!I(S)}async function V({targetWindow:e,isIframe:t,envVars:o}){var E;const a=new URLSearchParams(window.location.search),i=a.get("callback")||"",s=a.get("siteId");let n=new URL(i).hostname;n=n.startsWith("www.")?n.replace("www.",""):n;let A=!1;try{const w=await(await fetch(`${o.BACKEND_BASE_URL}/graphql`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({query:`
          query GetIsAllowedDomain($domain: String!) {
            isAllowedDomain(domain: $domain) {
              isAllowed
            }
          }
        `,variables:{domain:n},operationName:"GetIsAllowedDomain"})})).json();A=!!((E=w==null?void 0:w.isAllowedDomain)!=null&&E.isAllowed)}catch(_){}const r=await(await fetch(`${o.BACKEND_BASE_URL}/auto-login`,{method:"POST",headers:{"content-type":"application/json"},credentials:"include",body:JSON.stringify({siteId:s})})).json();if("error"in r)throw new Error("Auto login failed");e.postMessage({type:"MV_AUTHENTICATED",accessToken:r.access_token,refreshToken:r.refresh_token,expirationTime:P(r.expires_in),authType:"login",isAutoLogin:!0,isIframe:t},"*")}async function p({targetWindow:e,envVars:t,isIframe:o=!1}){U(e,t),v(e);const a=I(B)==="true";return a&&await V({targetWindow:e,isIframe:o,envVars:t}),{hasLoggedInCookie:a}}async function F({envVars:e}){const t=window.parent,a=new URLSearchParams(window.location.search).get("siteId");!t||!a||(M()||t.postMessage({type:"MV_COOKIES_NOT_ALLOWED"},"*"),await p({targetWindow:t,isIframe:!0,envVars:e}),t.postMessage({type:"MV_IFRAME_FLOW_COMPLETE"},"*"),window.addEventListener("message",i=>{i.data.type==="GROW_UNVERIFIED_READER_ID_ACQUIRED"&&(R({name:m,value:i.data.unverifiedReaderId}),u("unverified_reader_id_acquired_in_iframe",e))}))}const h={BACKEND_BASE_URL:L,SNOWPLOW_TRACKER_NAMESPACE:C,SNOWPLOW_COLLECTOR_URL:D,SNOWPLOW_APP_ID:N};function W(){return window.parent.location!==window.location}async function k(){const e=window.opener,o=new URLSearchParams(window.location.search).get("siteId");if(!e||!o)return{shouldKeepLoading:!0};const{hasLoggedInCookie:a}=await p({targetWindow:e,isIframe:!1,envVars:h});return{shouldKeepLoading:!a}}async function K(){var i,s;const t=new URLSearchParams(window.location.search).get("siteId");if(W()){try{await F({envVars:h})}catch(n){}return}else if(window.opener&&t&&window.location.pathname!=="/logout")try{const{shouldKeepLoading:n}=await k();if(!n){window.close();return}}catch(n){}const o=(i=document.currentScript)==null?void 0:i.getAttribute("data-grow-me-beta-name"),a=(s=document.currentScript)==null?void 0:s.getAttribute("data-grow-me-beta-version");g(()=>import("./initializeApp-30b364a8.js"),[]).then(({initializeApp:n})=>{n({betaName:o,betaVersion:a})})}K();export{L as B,Z as C,b as F,z as G,J as L,ee as M,ne as P,D as S,Q as T,G as __vite_legacy_guard,j as a,$ as b,H as c,Y as d,x as e,q as f,N as g,C as h,ae as i,ie as j,re as k,se as l,ce as m,te as n,oe as o,X as p};
